# Failed Login Monitor

This project provides a Python script (`monitor.py`) to monitor log files for repeated failed login attempts, potentially indicating a brute-force attack. When a configured threshold of failed attempts from a single IP address within a specific time window is reached, it sends an email alert.

A simple Flask application (`test_app.py`) is included to simulate login attempts and generate log entries in the expected format for testing purposes.

## Features

*   Monitors a specified log file in real-time.
*   Detects multiple failed login attempts from the same IP address within a configurable time window.
*   Sends email alerts when the failed attempt threshold is exceeded.
*   Configurable log format regex, thresholds, time window, and email settings.
*   Includes a test Flask application to generate sample log data.

## Requirements

*   Python 3.x
*   Flask (for the test application)

## Setup

1.  **Clone or download the repository:**
    ```bash
    # If using git
    git clone <repository_url>
    cd failed_login_monitor
    ```

2.  **Install dependencies:**
    It's recommended to use a virtual environment:
    ```bash
    python -m venv venv
    # On Windows
    .\venv\Scripts\activate
    # On macOS/Linux
    source venv/bin/activate

    pip install -r requirements.txt
    ```

## Configuration

### `monitor.py`

Open `monitor.py` and adjust the configuration variables at the top of the script:

*   `LOG_FILE_PATH`: Set the absolute path to the log file you want to monitor (e.g., SSH logs, web server logs). The default is `attempts.log` generated by `test_app.py`.
*   `LOG_FORMAT_REGEX`: **Crucially, adjust this regular expression** to match the format of failed login entries in *your specific log file*. The default regex is designed for the format produced by `test_app.py`.
*   `TIME_WINDOW_SECONDS`: The time window (in seconds) to track failed attempts from an IP.
*   `MAX_FAILED_ATTEMPTS`: The number of failed attempts within the time window to trigger an alert.
*   `ALERT_EMAIL_TO`: The email address to send alerts to.
*   `ALERT_EMAIL_FROM`: The email address alerts should be sent from.
*   `SMTP_SERVER`: The hostname or IP address of your SMTP server.
*   `SMTP_PORT`: The port for your SMTP server (e.g., 25, 587 for TLS, 465 for SSL).
*   `SMTP_USER`, `SMTP_PASSWORD`: Set these if your SMTP server requires authentication. Uncomment the `server.starttls()` and `server.login()` lines if using TLS/authentication.

### `test_app.py`

This application is primarily for testing the monitor. It writes log entries to `attempts.log` in the project directory. No specific configuration is usually needed unless you want to change the port it runs on.

## Usage

1.  **Start the Monitor:**
    Open a terminal, navigate to the project directory, and run:
    ```bash
    python monitor.py
    ```
    You can override default configuration using command-line arguments:
    ```bash
    python monitor.py --logfile /path/to/your/actual.log --threshold 10 --window 600
    ```
    The monitor will start tailing the specified log file.

2.  **Run the Test Application (Optional):**
    To generate test log entries, open *another* terminal, navigate to the project directory, and run:
    ```bash
    python test_app.py
    ```
    This will start a simple web server usually on `http://127.0.0.1:5000`. Access this URL in your browser and try submitting the login form with incorrect credentials multiple times to trigger the monitor.

3.  **Check for Alerts:**
    If the conditions configured in `monitor.py` are met (e.g., 5 failed attempts from the same IP within 5 minutes by default), the script will print an alert to the console and attempt to send an email to the configured address.
